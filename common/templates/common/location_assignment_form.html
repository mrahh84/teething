{% extends "base.html" %}
{% load static %}

{% block title %}Location Assignment - Road Attendance System{% endblock %}

{% block secondary_nav %}
{% include 'secondary_nav.html' %}
{% block secondary_nav_tabs %}
<a href="{% url 'location_dashboard' %}" class="secondary-nav-tab {% if request.resolver_match.url_name == 'location_dashboard' %}active{% endif %}">
    üìç Dashboard
</a>
<a href="{% url 'location_assignment_list' %}" class="secondary-nav-tab {% if request.resolver_match.url_name == 'location_assignment_list' %}active{% endif %}">
    üìã Assignments
</a>
{% endblock %}
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h1 class="dashboard-title">üìç Location Assignment</h1>
        <p class="dashboard-subtitle">Assign employees to locations</p>
    </div>
    
    <div class="section">
        <div class="section-header">
            <h3 class="section-title">üìã Assignment Form</h3>
        </div>
        <div class="section-body">
            <form method="post" class="card-grid">
                {% csrf_token %}
                
                <div class="card">
                    <div class="card-label">Employee</div>
                    <select name="employee" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px;">
                        <option value="">Select Employee</option>
                        {% for employee in employees %}
                        <option value="{{ employee.id }}" {% if form.employee.value == employee.id %}selected{% endif %}>
                            {{ employee.given_name }} {{ employee.surname }} - {{ employee.department.name|default:"No Department" }}
                        </option>
                        {% endfor %}
                    </select>
                    {% if form.employee.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.employee.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <div class="card">
                    <div class="card-label">Location</div>
                    <select name="location" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px;">
                        <option value="">Select Location</option>
                        {% for location in locations %}
                        <option value="{{ location.id }}" {% if form.location.value == location.id %}selected{% endif %}>
                            {{ location.name }} (Capacity: {{ location.capacity }})
                        </option>
                        {% endfor %}
                    </select>
                    {% if form.location.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.location.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <div class="card">
                    <div class="card-label">Task Type</div>
                    <select name="task_type" style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px;">
                        <option value="">Select Task Type</option>
                        <option value="general" {% if form.task_type.value == 'general' %}selected{% endif %}>General Assignment</option>
                        <option value="maintenance" {% if form.task_type.value == 'maintenance' %}selected{% endif %}>Maintenance</option>
                        <option value="cleaning" {% if form.task_type.value == 'cleaning' %}selected{% endif %}>Cleaning</option>
                        <option value="security" {% if form.task_type.value == 'security' %}selected{% endif %}>Security</option>
                        <option value="supervision" {% if form.task_type.value == 'supervision' %}selected{% endif %}>Supervision</option>
                    </select>
                    {% if form.task_type.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.task_type.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <div class="card">
                    <div class="card-label">Assigned Date</div>
                    <input type="date" name="assigned_date" value="{{ form.assigned_date.value|default:'' }}" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px;">
                    {% if form.assigned_date.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.assigned_date.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <div class="card">
                    <div class="card-label">Status</div>
                    <select name="status" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px;">
                        <option value="">Select Status</option>
                        <option value="pending" {% if form.status.value == 'pending' %}selected{% endif %}>Pending</option>
                        <option value="in_progress" {% if form.status.value == 'in_progress' %}selected{% endif %}>In Progress</option>
                        <option value="completed" {% if form.status.value == 'completed' %}selected{% endif %}>Completed</option>
                    </select>
                    {% if form.status.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.status.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <div class="card">
                    <div class="card-label">Notes</div>
                    <textarea name="notes" rows="3" style="width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px; resize: vertical;">{{ form.notes.value|default:'' }}</textarea>
                    {% if form.notes.errors %}
                    <div style="color: var(--danger-color); font-size: 0.8rem; margin-top: 0.25rem;">{{ form.notes.errors.0 }}</div>
                    {% endif %}
                </div>
            </form>
            
            <div style="margin-top: 2rem; text-align: center;">
                <button type="submit" class="btn btn-primary">üíæ Save Assignment</button>
                <a href="{% url 'location_assignment_list' %}" class="btn btn-secondary">‚ùå Cancel</a>
            </div>
        </div>
    </div>
</div>
{% endblock %} 